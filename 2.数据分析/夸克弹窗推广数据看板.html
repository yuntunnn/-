<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤¸å…‹AIå¼¹çª—æ¨å¹¿æ•°æ®çœ‹æ¿</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0e1a;
            --bg-secondary: #111827;
            --bg-card: #1a2035;
            --bg-card-hover: #1f2847;
            --border-color: rgba(99, 130, 255, 0.12);
            --text-primary: #f0f4ff;
            --text-secondary: #8b95b0;
            --text-muted: #5a647d;
            --accent-blue: #6366f1;
            --accent-cyan: #06b6d4;
            --accent-green: #10b981;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-purple: #a855f7;
            --gradient-blue: linear-gradient(135deg, #6366f1, #818cf8);
            --gradient-cyan: linear-gradient(135deg, #06b6d4, #22d3ee);
            --gradient-green: linear-gradient(135deg, #10b981, #34d399);
            --gradient-amber: linear-gradient(135deg, #f59e0b, #fbbf24);
            --gradient-rose: linear-gradient(135deg, #f43f5e, #fb7185);
            --gradient-purple: linear-gradient(135deg, #a855f7, #c084fc);
            --shadow: 0 4px 24px rgba(0,0,0,0.25);
            --shadow-glow-blue: 0 0 30px rgba(99, 102, 241, 0.15);
            --shadow-glow-cyan: 0 0 30px rgba(6, 182, 212, 0.15);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Background Decoration */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(ellipse at 30% 20%, rgba(99, 102, 241, 0.08) 0%, transparent 50%),
                        radial-gradient(ellipse at 70% 80%, rgba(6, 182, 212, 0.06) 0%, transparent 50%);
            z-index: 0;
            pointer-events: none;
        }

        .dashboard-container {
            position: relative;
            z-index: 1;
            max-width: 1440px;
            margin: 0 auto;
            padding: 32px 40px;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 36px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-icon {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            background: var(--gradient-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: var(--shadow-glow-blue);
        }

        .header h1 {
            font-size: 26px;
            font-weight: 700;
            letter-spacing: -0.5px;
            background: linear-gradient(135deg, #f0f4ff 0%, #818cf8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-subtitle {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .header-meta {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .meta-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 20px;
            font-size: 12px;
            color: #818cf8;
            font-weight: 500;
        }

        .meta-badge .dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        /* KPI Cards */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 16px;
            margin-bottom: 28px;
        }

        .kpi-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 22px 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .kpi-card:hover {
            background: var(--bg-card-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            border-radius: 16px 16px 0 0;
        }

        .kpi-card:nth-child(1)::before { background: var(--gradient-blue); }
        .kpi-card:nth-child(2)::before { background: var(--gradient-cyan); }
        .kpi-card:nth-child(3)::before { background: var(--gradient-green); }
        .kpi-card:nth-child(4)::before { background: var(--gradient-amber); }
        .kpi-card:nth-child(5)::before { background: var(--gradient-rose); }

        .kpi-label {
            font-size: 12px;
            color: var(--text-muted);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
        }

        .kpi-value {
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -1px;
            margin-bottom: 6px;
        }

        .kpi-card:nth-child(1) .kpi-value { color: #818cf8; }
        .kpi-card:nth-child(2) .kpi-value { color: #22d3ee; }
        .kpi-card:nth-child(3) .kpi-value { color: #34d399; }
        .kpi-card:nth-child(4) .kpi-value { color: #fbbf24; }
        .kpi-card:nth-child(5) .kpi-value { color: #fb7185; }

        .kpi-sub {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .kpi-sub .highlight {
            font-weight: 600;
        }

        /* Chart Section */
        .section-title {
            font-size: 17px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title .icon {
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 28px;
        }

        .chart-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .chart-card:hover {
            box-shadow: var(--shadow);
        }

        .chart-card.full-width {
            grid-column: 1 / -1;
        }

        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 18px;
        }

        .chart-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .chart-subtitle {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .chart-container {
            width: 100%;
            height: 340px;
        }

        .chart-container.tall {
            height: 420px;
        }

        /* Funnel Data Table */
        .funnel-table-wrapper {
            overflow-x: auto;
            margin-top: 16px;
        }

        .funnel-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .funnel-table th {
            padding: 10px 12px;
            text-align: right;
            color: var(--text-muted);
            font-weight: 500;
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
        }

        .funnel-table th:first-child {
            text-align: left;
        }

        .funnel-table td {
            padding: 8px 12px;
            text-align: right;
            color: var(--text-secondary);
            border-bottom: 1px solid rgba(99, 130, 255, 0.06);
        }

        .funnel-table td:first-child {
            text-align: left;
            color: var(--text-primary);
            font-weight: 500;
        }

        .funnel-table tbody tr:hover {
            background: rgba(99, 102, 241, 0.05);
        }

        .rate-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 600;
        }

        .rate-badge.good { background: rgba(16, 185, 129, 0.15); color: #34d399; }
        .rate-badge.warn { background: rgba(245, 158, 11, 0.15); color: #fbbf24; }
        .rate-badge.bad  { background: rgba(244, 63, 94, 0.15); color: #fb7185; }

        /* Insights Panel */
        .insights-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 28px;
        }

        .insight-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
        }

        .insight-card h3 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .insight-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(99, 130, 255, 0.06);
        }

        .insight-item:last-child {
            border-bottom: none;
        }

        .insight-bullet {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-top: 6px;
            flex-shrink: 0;
        }

        .insight-text {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .insight-text strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .insight-text .num {
            color: #818cf8;
            font-weight: 600;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 24px 0;
            margin-top: 20px;
            border-top: 1px solid var(--border-color);
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .kpi-grid { grid-template-columns: repeat(3, 1fr); }
        }

        @media (max-width: 768px) {
            .dashboard-container { padding: 20px 16px; }
            .kpi-grid { grid-template-columns: repeat(2, 1fr); }
            .charts-grid { grid-template-columns: 1fr; }
            .insights-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <div class="header-icon">ğŸš€</div>
                <div>
                    <h1>å¤¸å…‹AIå¼¹çª—æ¨å¹¿æ•°æ®çœ‹æ¿</h1>
                    <div class="header-subtitle">smart_recommend Â· å¼¹çª—æ¨å¹¿å…¨é“¾è·¯åˆ†æ</div>
                </div>
            </div>
            <div class="header-meta">
                <div class="meta-badge">
                    <span class="dot"></span>
                    æ•°æ®å‘¨æœŸï¼š2026.02.09 â€“ 02.24
                </div>
                <div class="meta-badge">
                    å…± 16 å¤©
                </div>
            </div>
        </div>

        <!-- KPI Cards -->
        <div class="kpi-grid" id="kpiGrid"></div>

        <!-- Trend Charts -->
        <div class="charts-grid">
            <div class="chart-card full-width">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">ğŸ“ˆ æ¯æ—¥ç”¨æˆ·è§¦è¾¾è¶‹åŠ¿</div>
                        <div class="chart-subtitle">start / trigger / show ä¸‰é˜¶æ®µç”¨æˆ·é‡</div>
                    </div>
                </div>
                <div class="chart-container" id="trendChart"></div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">ğŸ¯ å¼¹çª—ç‚¹å‡»ç‡è¶‹åŠ¿</div>
                        <div class="chart-subtitle">pop_click / pop_showï¼ˆå»é™¤æµ‹è¯•æœŸï¼‰</div>
                    </div>
                </div>
                <div class="chart-container" id="clickRateChart"></div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">â¬‡ï¸ ä¸‹è½½æˆåŠŸç‡è¶‹åŠ¿</div>
                        <div class="chart-subtitle">down_suc / pop_click</div>
                    </div>
                </div>
                <div class="chart-container" id="downloadRateChart"></div>
            </div>
        </div>

        <!-- Funnel -->
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">ğŸ”½ å…¨é“¾è·¯è½¬åŒ–æ¼æ–—</div>
                        <div class="chart-subtitle">å…¨å‘¨æœŸç´¯è®¡äººæ•°</div>
                    </div>
                </div>
                <div class="chart-container tall" id="funnelChart"></div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">ğŸ“Š å„é˜¶æ®µè½¬åŒ–ç‡</div>
                        <div class="chart-subtitle">ç›¸é‚»é˜¶æ®µé—´è½¬åŒ–ç‡</div>
                    </div>
                </div>
                <div class="chart-container tall" id="conversionBarChart"></div>
            </div>
        </div>

        <!-- Daily Volume & Breakdown -->
        <div class="charts-grid">
            <div class="chart-card full-width">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">ğŸ“‹ ç”¨æˆ·è¡Œä¸ºæ„æˆåˆ†æ</div>
                        <div class="chart-subtitle">å¼¹çª—å±•ç¤ºåçš„ç”¨æˆ·è¡Œä¸ºåˆ†å¸ƒï¼ˆæ¯æ—¥ï¼‰</div>
                    </div>
                </div>
                <div class="chart-container" id="behaviorStackChart"></div>
            </div>
        </div>

        <!-- Download Analysis -->
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">ğŸ“¥ æ¯æ—¥ä¸‹è½½é‡</div>
                        <div class="chart-subtitle">ä¸‹è½½æˆåŠŸ vs ä¸‹è½½å®Œæˆ</div>
                    </div>
                </div>
                <div class="chart-container" id="downloadChart"></div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">ğŸ”„ æµå¤±åˆ†æ</div>
                        <div class="chart-subtitle">å„ç¯èŠ‚æµå¤±äººæ•°ï¼ˆè¿‘7å¤©å‡å€¼ï¼‰</div>
                    </div>
                </div>
                <div class="chart-container" id="lossChart"></div>
            </div>
        </div>

        <!-- Insights -->
        <div class="insights-grid">
            <div class="insight-card">
                <h3>ğŸ’¡ æ ¸å¿ƒå‘ç°</h3>
                <div class="insight-item">
                    <div class="insight-bullet" style="background: var(--accent-blue);"></div>
                    <div class="insight-text">
                        <strong>å¼¹çª—è§¦è¾¾ç‡ç¨³å®š</strong>ï¼štriggerâ†’show è½¬åŒ–ç‡ç»´æŒåœ¨ <span class="num">96%-98%</span>ï¼Œæ¨å¹¿è§¦å‘é€»è¾‘è¿è¡Œè‰¯å¥½ã€‚
                    </div>
                </div>
                <div class="insight-item">
                    <div class="insight-bullet" style="background: var(--accent-amber);"></div>
                    <div class="insight-text">
                        <strong>å¼¹çª—ç‚¹å‡»ç‡åä½</strong>ï¼šæ•´ä½“ç‚¹å‡»ç‡çº¦ <span class="num">0.8%-1.4%</span>ï¼Œç”¨æˆ·å¯¹å¼¹çª—æ¨èçš„å“åº”è¾ƒä¸ºæœ‰é™ï¼Œå­˜åœ¨ä¼˜åŒ–ç©ºé—´ã€‚
                    </div>
                </div>
                <div class="insight-item">
                    <div class="insight-bullet" style="background: var(--accent-green);"></div>
                    <div class="insight-text">
                        <strong>ä¸‹è½½è½¬åŒ–ç‡ä¼˜ç§€</strong>ï¼šç‚¹å‡»â†’ä¸‹è½½æˆåŠŸè½¬åŒ–ç‡è¾¾ <span class="num">85%-95%</span>ï¼Œä¸‹è½½é“¾è·¯é¡ºç•…ï¼Œç”¨æˆ·ä¸€æ—¦å†³å®šä¸‹è½½åŸºæœ¬èƒ½å¤ŸæˆåŠŸã€‚
                    </div>
                </div>
                <div class="insight-item">
                    <div class="insight-bullet" style="background: var(--accent-purple);"></div>
                    <div class="insight-text">
                        <strong>æµé‡é˜¶æ¢¯å¼æ”¾é‡</strong>ï¼š2/13 é¦–æ¬¡å¤§è§„æ¨¡æ”¾é‡è‡³ <span class="num">~6ä¸‡</span> ç”¨æˆ·ï¼Œ2/14-20 å›è½è‡³ <span class="num">~2åƒ</span>ï¼Œ2/21 èµ·å†æ¬¡æ”¾é‡è‡³ <span class="num">3-6ä¸‡</span>ã€‚
                    </div>
                </div>
            </div>

            <div class="insight-card">
                <h3>ğŸ“Œ ä¼˜åŒ–å»ºè®®</h3>
                <div class="insight-item">
                    <div class="insight-bullet" style="background: var(--accent-rose);"></div>
                    <div class="insight-text">
                        <strong>æå‡å¼¹çª—ç‚¹å‡»ç‡</strong>ï¼šå½“å‰å¼¹çª—ç‚¹å‡»ç‡ä¸è¶³ 1%ï¼Œå»ºè®®ä¼˜åŒ–å¼¹çª—æ–‡æ¡ˆã€è§†è§‰è®¾è®¡åŠå±•ç¤ºæ—¶æœºï¼Œæå‡å¸å¼•åŠ›ã€‚
                    </div>
                </div>
                <div class="insight-item">
                    <div class="insight-bullet" style="background: var(--accent-cyan);"></div>
                    <div class="insight-text">
                        <strong>å…³æ³¨ break ä¸­æ–­ç‡</strong>ï¼šæ¯æ—¥æœ‰ <span class="num">15%-25%</span> çš„ start ç”¨æˆ·åœ¨é“¾è·¯ä¸­ breakï¼Œéœ€æ’æŸ¥ä¸­æ–­åŸå› ï¼ˆç½‘ç»œ/åŠ è½½/ç”¨æˆ·ä¸»åŠ¨é€€å‡ºï¼‰ã€‚
                    </div>
                </div>
                <div class="insight-item">
                    <div class="insight-bullet" style="background: var(--accent-amber);"></div>
                    <div class="insight-text">
                        <strong>ä¼˜åŒ–"ä¸å†æç¤º"å æ¯”</strong>ï¼špop_notips å å±•ç¤ºçš„ <span class="num">~2%</span>ï¼Œåº”æŒç»­å…³æ³¨æ­¤æŒ‡æ ‡ï¼Œé¿å…è¿‡äºæ‰“æ‰°ç”¨æˆ·ã€‚
                    </div>
                </div>
                <div class="insight-item">
                    <div class="insight-bullet" style="background: var(--accent-blue);"></div>
                    <div class="insight-text">
                        <strong>ç¨³å®šæ”¾é‡ç»§ç»­è§‚å¯Ÿ</strong>ï¼š2/21è¿ç»­æ”¾é‡åæ•°æ®è¶‹ç¨³ï¼Œå»ºè®®ä¿æŒå½“å‰æ”¾é‡åŠ›åº¦å¹¶æŒç»­ç›‘æ§å„é¡¹è½¬åŒ–æŒ‡æ ‡ã€‚
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Table -->
        <div class="chart-card" style="margin-bottom: 28px;">
            <div class="chart-header">
                <div>
                    <div class="chart-title">ğŸ“‹ æ¯æ—¥æ˜ç»†æ•°æ®</div>
                    <div class="chart-subtitle">å…¨é“¾è·¯å„èŠ‚ç‚¹äººæ•°ä¸è½¬åŒ–ç‡</div>
                </div>
            </div>
            <div class="funnel-table-wrapper">
                <table class="funnel-table" id="detailTable">
                    <thead>
                        <tr>
                            <th>æ—¥æœŸ</th>
                            <th>Start</th>
                            <th>Trigger</th>
                            <th>å¼¹çª—å±•ç¤º</th>
                            <th>å¼¹çª—ç‚¹å‡»</th>
                            <th>å¼¹çª—å…³é—­</th>
                            <th>ä¸å†æç¤º</th>
                            <th>ä¸‹è½½æˆåŠŸ</th>
                            <th>ä¸‹è½½å®Œæˆ</th>
                            <th>è§¦è¾¾ç‡</th>
                            <th>ç‚¹å‡»ç‡</th>
                            <th>ä¸‹è½½è½¬åŒ–</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <div class="footer">
            å¤¸å…‹AIå¼¹çª—æ¨å¹¿æ•°æ®çœ‹æ¿ Â· æ•°æ®æˆªè‡³ 2026-02-24 Â· è‡ªåŠ¨ç”Ÿæˆ
        </div>
    </div>

    <script>
    // ==================== DATA ====================
    const rawData = [
        { date: '02-09', start: 4, trigger: 4, show: 4, click: 4, close: 3, notips: 3, timeout: 0, down_start: 2, down_suc: 0, down_fail: 0, down_end_suc: 0, down_end_fail: 0, brk: 3 },
        { date: '02-10', start: 6, trigger: 6, show: 6, click: 3, close: 6, notips: 0, timeout: 0, down_start: 3, down_suc: 0, down_fail: 0, down_end_suc: 0, down_end_fail: 0, brk: 3 },
        { date: '02-11', start: 1541, trigger: 1305, show: 1240, click: 13, close: 1154, notips: 18, timeout: 38, down_start: 13, down_suc: 9, down_fail: 0, down_end_suc: 8, down_end_fail: 0, brk: 342 },
        { date: '02-12', start: 21428, trigger: 18542, show: 17948, click: 139, close: 16644, notips: 375, timeout: 473, down_start: 139, down_suc: 124, down_fail: 12, down_end_suc: 123, down_end_fail: 14, brk: 4030 },
        { date: '02-13', start: 61821, trigger: 53204, show: 51483, click: 363, close: 47984, notips: 1049, timeout: 1358, down_start: 353, down_suc: 321, down_fail: 27, down_end_suc: 319, down_end_fail: 22, brk: 11400 },
        { date: '02-14', start: 3439, trigger: 2615, show: 2522, click: 31, close: 2313, notips: 47, timeout: 66, down_start: 29, down_suc: 29, down_fail: 2, down_end_suc: 29, down_end_fail: 2, brk: 923 },
        { date: '02-15', start: 2421, trigger: 1867, show: 1804, click: 26, close: 1625, notips: 49, timeout: 68, down_start: 25, down_suc: 24, down_fail: 0, down_end_suc: 24, down_end_fail: 0, brk: 611 },
        { date: '02-16', start: 2044, trigger: 1631, show: 1573, click: 12, close: 1447, notips: 35, timeout: 39, down_start: 12, down_suc: 12, down_fail: 0, down_end_suc: 12, down_end_fail: 0, brk: 440 },
        { date: '02-17', start: 1867, trigger: 1495, show: 1451, click: 12, close: 1320, notips: 34, timeout: 38, down_start: 12, down_suc: 11, down_fail: 0, down_end_suc: 11, down_end_fail: 0, brk: 392 },
        { date: '02-18', start: 1993, trigger: 1641, show: 1599, click: 19, close: 1474, notips: 34, timeout: 32, down_start: 17, down_suc: 15, down_fail: 0, down_end_suc: 15, down_end_fail: 0, brk: 406 },
        { date: '02-19', start: 1991, trigger: 1651, show: 1610, click: 21, close: 1495, notips: 40, timeout: 31, down_start: 19, down_suc: 18, down_fail: 0, down_end_suc: 18, down_end_fail: 0, brk: 377 },
        { date: '02-20', start: 2042, trigger: 1701, show: 1651, click: 14, close: 1532, notips: 35, timeout: 32, down_start: 12, down_suc: 12, down_fail: 0, down_end_suc: 12, down_end_fail: 0, brk: 403 },
        { date: '02-21', start: 33523, trigger: 29006, show: 28257, click: 291, close: 26260, notips: 622, timeout: 713, down_start: 291, down_suc: 265, down_fail: 18, down_end_suc: 263, down_end_fail: 17, brk: 5959 },
        { date: '02-22', start: 39767, trigger: 34268, show: 33391, click: 276, close: 31069, notips: 710, timeout: 905, down_start: 275, down_suc: 250, down_fail: 20, down_end_suc: 249, down_end_fail: 21, brk: 7364 },
        { date: '02-23', start: 43841, trigger: 37052, show: 35999, click: 318, close: 33481, notips: 846, timeout: 932, down_start: 314, down_suc: 292, down_fail: 16, down_end_suc: 293, down_end_fail: 17, brk: 8534 },
        { date: '02-24', start: 63715, trigger: 53943, show: 52248, click: 447, close: 48635, notips: 1162, timeout: 1358, down_start: 449, down_suc: 412, down_fail: 28, down_end_suc: 409, down_end_fail: 32, brk: 12456 },
    ];

    // Skip test period (02-09, 02-10) for analysis charts
    const mainData = rawData.filter(d => d.start > 100);

    // ==================== UTILITIES ====================
    function formatNum(n) {
        if (n >= 10000) return (n / 10000).toFixed(1) + 'ä¸‡';
        if (n >= 1000) return (n / 1000).toFixed(1) + 'k';
        return n.toString();
    }

    function pct(a, b) {
        if (!b) return 0;
        return +(a / b * 100).toFixed(2);
    }

    // ==================== KPI CARDS ====================
    function renderKPIs() {
        const totalStart = mainData.reduce((s, d) => s + d.start, 0);
        const totalShow = mainData.reduce((s, d) => s + d.show, 0);
        const totalClick = mainData.reduce((s, d) => s + d.click, 0);
        const totalDownSuc = mainData.reduce((s, d) => s + d.down_suc, 0);
        const totalEndSuc = mainData.reduce((s, d) => s + d.down_end_suc, 0);

        const kpis = [
            { label: 'ç´¯è®¡è§¦è¾¾ç”¨æˆ·', value: formatNum(totalStart), sub: `æ—¥å‡ ${formatNum(Math.round(totalStart / mainData.length))}` },
            { label: 'ç´¯è®¡å¼¹çª—å±•ç¤º', value: formatNum(totalShow), sub: `å±•ç¤ºç‡ ${pct(totalShow, totalStart).toFixed(1)}%` },
            { label: 'ç´¯è®¡å¼¹çª—ç‚¹å‡»', value: formatNum(totalClick), sub: `ç‚¹å‡»ç‡ ${pct(totalClick, totalShow).toFixed(2)}%` },
            { label: 'ç´¯è®¡ä¸‹è½½æˆåŠŸ', value: formatNum(totalDownSuc), sub: `ä¸‹è½½è½¬åŒ– ${pct(totalDownSuc, totalClick).toFixed(1)}%` },
            { label: 'ç´¯è®¡ä¸‹è½½å®Œæˆ', value: formatNum(totalEndSuc), sub: `å®Œæˆç‡ ${pct(totalEndSuc, totalDownSuc).toFixed(1)}%` },
        ];

        const grid = document.getElementById('kpiGrid');
        grid.innerHTML = kpis.map(k => `
            <div class="kpi-card">
                <div class="kpi-label">${k.label}</div>
                <div class="kpi-value">${k.value}</div>
                <div class="kpi-sub">${k.sub}</div>
            </div>
        `).join('');
    }

    // ==================== CHARTS ====================
    const chartTheme = {
        textStyle: { fontFamily: 'Inter, sans-serif' },
        grid: { left: 60, right: 30, top: 40, bottom: 40 },
    };

    // 1. Trend Chart
    function renderTrendChart() {
        const chart = echarts.init(document.getElementById('trendChart'));
        chart.setOption({
            ...chartTheme,
            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(17, 24, 39, 0.95)',
                borderColor: 'rgba(99, 130, 255, 0.2)',
                textStyle: { color: '#f0f4ff', fontSize: 12 },
            },
            legend: {
                data: ['Start è§¦è¾¾', 'Trigger è§¦å‘', 'Show å±•ç¤º'],
                textStyle: { color: '#8b95b0', fontSize: 12 },
                top: 5,
                right: 20,
            },
            xAxis: {
                type: 'category',
                data: mainData.map(d => d.date),
                axisLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.2)' } },
                axisLabel: { color: '#8b95b0', fontSize: 11 },
            },
            yAxis: {
                type: 'value',
                axisLine: { show: false },
                splitLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.08)' } },
                axisLabel: {
                    color: '#8b95b0',
                    fontSize: 11,
                    formatter: v => v >= 10000 ? (v/10000).toFixed(0) + 'ä¸‡' : v >= 1000 ? (v/1000).toFixed(0) + 'k' : v,
                },
            },
            series: [
                {
                    name: 'Start è§¦è¾¾',
                    type: 'line',
                    data: mainData.map(d => d.start),
                    smooth: true,
                    lineStyle: { width: 3, color: '#6366f1' },
                    itemStyle: { color: '#6366f1' },
                    areaStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: 'rgba(99, 102, 241, 0.25)' },
                            { offset: 1, color: 'rgba(99, 102, 241, 0.02)' },
                        ]),
                    },
                    symbol: 'circle',
                    symbolSize: 6,
                },
                {
                    name: 'Trigger è§¦å‘',
                    type: 'line',
                    data: mainData.map(d => d.trigger),
                    smooth: true,
                    lineStyle: { width: 2.5, color: '#06b6d4' },
                    itemStyle: { color: '#06b6d4' },
                    symbol: 'circle',
                    symbolSize: 5,
                },
                {
                    name: 'Show å±•ç¤º',
                    type: 'line',
                    data: mainData.map(d => d.show),
                    smooth: true,
                    lineStyle: { width: 2, color: '#10b981' },
                    itemStyle: { color: '#10b981' },
                    symbol: 'circle',
                    symbolSize: 4,
                },
            ],
        });
        window.addEventListener('resize', () => chart.resize());
    }

    // 2. Click Rate Chart
    function renderClickRateChart() {
        const chart = echarts.init(document.getElementById('clickRateChart'));
        const rates = mainData.map(d => pct(d.click, d.show));
        chart.setOption({
            ...chartTheme,
            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(17, 24, 39, 0.95)',
                borderColor: 'rgba(99, 130, 255, 0.2)',
                textStyle: { color: '#f0f4ff', fontSize: 12 },
                formatter: params => {
                    const p = params[0];
                    const d = mainData[p.dataIndex];
                    return `${p.name}<br/>ç‚¹å‡»ç‡: <b>${p.value}%</b><br/>ç‚¹å‡»: ${d.click} / å±•ç¤º: ${d.show}`;
                },
            },
            xAxis: {
                type: 'category',
                data: mainData.map(d => d.date),
                axisLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.2)' } },
                axisLabel: { color: '#8b95b0', fontSize: 11 },
            },
            yAxis: {
                type: 'value',
                axisLine: { show: false },
                splitLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.08)' } },
                axisLabel: { color: '#8b95b0', fontSize: 11, formatter: v => v + '%' },
                min: 0,
                max: 2,
            },
            series: [{
                type: 'bar',
                data: rates,
                barWidth: 24,
                itemStyle: {
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        { offset: 0, color: '#f59e0b' },
                        { offset: 1, color: 'rgba(245, 158, 11, 0.3)' },
                    ]),
                    borderRadius: [4, 4, 0, 0],
                },
                label: {
                    show: true,
                    position: 'top',
                    color: '#fbbf24',
                    fontSize: 10,
                    formatter: p => p.value + '%',
                },
            },
            {
                type: 'line',
                data: rates,
                smooth: true,
                lineStyle: { width: 2, color: '#f59e0b', type: 'dashed' },
                itemStyle: { color: '#f59e0b' },
                symbol: 'none',
            }],
        });
        window.addEventListener('resize', () => chart.resize());
    }

    // 3. Download Rate Chart
    function renderDownloadRateChart() {
        const chart = echarts.init(document.getElementById('downloadRateChart'));
        const downRates = mainData.map(d => pct(d.down_suc, d.click));
        chart.setOption({
            ...chartTheme,
            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(17, 24, 39, 0.95)',
                borderColor: 'rgba(99, 130, 255, 0.2)',
                textStyle: { color: '#f0f4ff', fontSize: 12 },
                formatter: params => {
                    const p = params[0];
                    const d = mainData[p.dataIndex];
                    return `${p.name}<br/>ä¸‹è½½æˆåŠŸç‡: <b>${p.value}%</b><br/>ä¸‹è½½: ${d.down_suc} / ç‚¹å‡»: ${d.click}`;
                },
            },
            xAxis: {
                type: 'category',
                data: mainData.map(d => d.date),
                axisLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.2)' } },
                axisLabel: { color: '#8b95b0', fontSize: 11 },
            },
            yAxis: {
                type: 'value',
                axisLine: { show: false },
                splitLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.08)' } },
                axisLabel: { color: '#8b95b0', fontSize: 11, formatter: v => v + '%' },
                min: 50,
                max: 110,
            },
            series: [{
                type: 'line',
                data: downRates,
                smooth: true,
                lineStyle: { width: 3, color: '#10b981' },
                itemStyle: { color: '#10b981' },
                areaStyle: {
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        { offset: 0, color: 'rgba(16, 185, 129, 0.3)' },
                        { offset: 1, color: 'rgba(16, 185, 129, 0.02)' },
                    ]),
                },
                symbol: 'circle',
                symbolSize: 8,
                label: {
                    show: true,
                    position: 'top',
                    color: '#34d399',
                    fontSize: 10,
                    formatter: p => p.value + '%',
                },
            }],
        });
        window.addEventListener('resize', () => chart.resize());
    }

    // 4. Funnel Chart
    function renderFunnelChart() {
        const chart = echarts.init(document.getElementById('funnelChart'));
        const totalStart = mainData.reduce((s, d) => s + d.start, 0);
        const totalTrigger = mainData.reduce((s, d) => s + d.trigger, 0);
        const totalShow = mainData.reduce((s, d) => s + d.show, 0);
        const totalClick = mainData.reduce((s, d) => s + d.click, 0);
        const totalDownSuc = mainData.reduce((s, d) => s + d.down_suc, 0);
        const totalEndSuc = mainData.reduce((s, d) => s + d.down_end_suc, 0);

        chart.setOption({
            ...chartTheme,
            tooltip: {
                trigger: 'item',
                backgroundColor: 'rgba(17, 24, 39, 0.95)',
                borderColor: 'rgba(99, 130, 255, 0.2)',
                textStyle: { color: '#f0f4ff', fontSize: 12 },
                formatter: p => `${p.name}<br/>äººæ•°: <b>${p.value.toLocaleString()}</b><br/>å Start: ${pct(p.value, totalStart)}%`,
            },
            series: [{
                type: 'funnel',
                left: '15%',
                top: 30,
                bottom: 20,
                width: '70%',
                min: 0,
                max: totalStart,
                minSize: '8%',
                maxSize: '100%',
                sort: 'descending',
                gap: 4,
                label: {
                    show: true,
                    position: 'inside',
                    color: '#fff',
                    fontSize: 12,
                    fontWeight: 600,
                    formatter: p => `${p.name}\n${p.value.toLocaleString()}`,
                },
                itemStyle: { borderWidth: 0 },
                data: [
                    { value: totalStart, name: 'Start è§¦è¾¾', itemStyle: { color: '#6366f1' }},
                    { value: totalTrigger, name: 'Trigger è§¦å‘', itemStyle: { color: '#818cf8' }},
                    { value: totalShow, name: 'å¼¹çª—å±•ç¤º', itemStyle: { color: '#06b6d4' }},
                    { value: totalClick, name: 'å¼¹çª—ç‚¹å‡»', itemStyle: { color: '#f59e0b' }},
                    { value: totalDownSuc, name: 'ä¸‹è½½æˆåŠŸ', itemStyle: { color: '#10b981' }},
                    { value: totalEndSuc, name: 'ä¸‹è½½å®Œæˆ', itemStyle: { color: '#34d399' }},
                ],
            }],
        });
        window.addEventListener('resize', () => chart.resize());
    }

    // 5. Conversion Bar Chart
    function renderConversionBarChart() {
        const chart = echarts.init(document.getElementById('conversionBarChart'));
        const totalStart = mainData.reduce((s, d) => s + d.start, 0);
        const totalTrigger = mainData.reduce((s, d) => s + d.trigger, 0);
        const totalShow = mainData.reduce((s, d) => s + d.show, 0);
        const totalClick = mainData.reduce((s, d) => s + d.click, 0);
        const totalDownSuc = mainData.reduce((s, d) => s + d.down_suc, 0);
        const totalEndSuc = mainData.reduce((s, d) => s + d.down_end_suc, 0);

        const stages = [
            { name: 'Startâ†’Trigger', rate: pct(totalTrigger, totalStart) },
            { name: 'Triggerâ†’Show', rate: pct(totalShow, totalTrigger) },
            { name: 'Showâ†’Click', rate: pct(totalClick, totalShow) },
            { name: 'Clickâ†’ä¸‹è½½æˆåŠŸ', rate: pct(totalDownSuc, totalClick) },
            { name: 'ä¸‹è½½â†’å®Œæˆ', rate: pct(totalEndSuc, totalDownSuc) },
        ];

        chart.setOption({
            ...chartTheme,
            grid: { left: 130, right: 60, top: 30, bottom: 30 },
            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(17, 24, 39, 0.95)',
                borderColor: 'rgba(99, 130, 255, 0.2)',
                textStyle: { color: '#f0f4ff', fontSize: 12 },
                formatter: p => `${p[0].name}: <b>${p[0].value}%</b>`,
            },
            xAxis: {
                type: 'value',
                max: 100,
                axisLine: { show: false },
                splitLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.08)' } },
                axisLabel: { color: '#8b95b0', fontSize: 11, formatter: v => v + '%' },
            },
            yAxis: {
                type: 'category',
                data: stages.map(s => s.name).reverse(),
                axisLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.2)' } },
                axisLabel: { color: '#d1d5db', fontSize: 12 },
            },
            series: [{
                type: 'bar',
                data: stages.map(s => s.rate).reverse(),
                barWidth: 28,
                itemStyle: {
                    borderRadius: [0, 6, 6, 0],
                    color: (params) => {
                        const colors = ['#34d399', '#10b981', '#f59e0b', '#06b6d4', '#6366f1'];
                        return colors[params.dataIndex];
                    },
                },
                label: {
                    show: true,
                    position: 'right',
                    color: '#d1d5db',
                    fontSize: 13,
                    fontWeight: 600,
                    formatter: p => p.value + '%',
                },
            }],
        });
        window.addEventListener('resize', () => chart.resize());
    }

    // 6. Behavior Stack Chart
    function renderBehaviorStackChart() {
        const chart = echarts.init(document.getElementById('behaviorStackChart'));
        chart.setOption({
            ...chartTheme,
            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(17, 24, 39, 0.95)',
                borderColor: 'rgba(99, 130, 255, 0.2)',
                textStyle: { color: '#f0f4ff', fontSize: 12 },
            },
            legend: {
                data: ['å¼¹çª—å…³é—­', 'å¼¹çª—ç‚¹å‡»', 'ä¸å†æç¤º', 'è¶…æ—¶'],
                textStyle: { color: '#8b95b0', fontSize: 12 },
                top: 5,
                right: 20,
            },
            xAxis: {
                type: 'category',
                data: mainData.map(d => d.date),
                axisLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.2)' } },
                axisLabel: { color: '#8b95b0', fontSize: 11 },
            },
            yAxis: {
                type: 'value',
                axisLine: { show: false },
                splitLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.08)' } },
                axisLabel: {
                    color: '#8b95b0',
                    fontSize: 11,
                    formatter: v => v >= 10000 ? (v/10000).toFixed(0) + 'ä¸‡' : v >= 1000 ? (v/1000).toFixed(0) + 'k' : v,
                },
            },
            series: [
                { name: 'å¼¹çª—å…³é—­', type: 'bar', stack: 'total', data: mainData.map(d => d.close), itemStyle: { color: '#64748b' }, barWidth: 22 },
                { name: 'å¼¹çª—ç‚¹å‡»', type: 'bar', stack: 'total', data: mainData.map(d => d.click), itemStyle: { color: '#6366f1' } },
                { name: 'ä¸å†æç¤º', type: 'bar', stack: 'total', data: mainData.map(d => d.notips), itemStyle: { color: '#f43f5e' } },
                { name: 'è¶…æ—¶', type: 'bar', stack: 'total', data: mainData.map(d => d.timeout), itemStyle: { color: '#f59e0b' } },
            ],
        });
        window.addEventListener('resize', () => chart.resize());
    }

    // 7. Download Chart
    function renderDownloadChart() {
        const chart = echarts.init(document.getElementById('downloadChart'));
        chart.setOption({
            ...chartTheme,
            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(17, 24, 39, 0.95)',
                borderColor: 'rgba(99, 130, 255, 0.2)',
                textStyle: { color: '#f0f4ff', fontSize: 12 },
            },
            legend: {
                data: ['ä¸‹è½½å¼€å§‹', 'ä¸‹è½½æˆåŠŸ', 'ä¸‹è½½å®Œæˆ', 'ä¸‹è½½å¤±è´¥'],
                textStyle: { color: '#8b95b0', fontSize: 12 },
                top: 5,
            },
            xAxis: {
                type: 'category',
                data: mainData.map(d => d.date),
                axisLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.2)' } },
                axisLabel: { color: '#8b95b0', fontSize: 11 },
            },
            yAxis: {
                type: 'value',
                axisLine: { show: false },
                splitLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.08)' } },
                axisLabel: { color: '#8b95b0', fontSize: 11 },
            },
            series: [
                { name: 'ä¸‹è½½å¼€å§‹', type: 'bar', data: mainData.map(d => d.down_start), itemStyle: { color: '#818cf8' }, barWidth: 12 },
                { name: 'ä¸‹è½½æˆåŠŸ', type: 'bar', data: mainData.map(d => d.down_suc), itemStyle: { color: '#10b981' }, barWidth: 12 },
                { name: 'ä¸‹è½½å®Œæˆ', type: 'bar', data: mainData.map(d => d.down_end_suc), itemStyle: { color: '#34d399' }, barWidth: 12 },
                { name: 'ä¸‹è½½å¤±è´¥', type: 'bar', data: mainData.map(d => d.down_fail), itemStyle: { color: '#f43f5e' }, barWidth: 12 },
            ],
        });
        window.addEventListener('resize', () => chart.resize());
    }

    // 8. Loss Chart (recent 7 days average)
    function renderLossChart() {
        const chart = echarts.init(document.getElementById('lossChart'));
        const recent = mainData.slice(-7);
        const n = recent.length;

        const avgStart = Math.round(recent.reduce((s, d) => s + d.start, 0) / n);
        const avgTrigger = Math.round(recent.reduce((s, d) => s + d.trigger, 0) / n);
        const avgShow = Math.round(recent.reduce((s, d) => s + d.show, 0) / n);
        const avgClick = Math.round(recent.reduce((s, d) => s + d.click, 0) / n);
        const avgDownSuc = Math.round(recent.reduce((s, d) => s + d.down_suc, 0) / n);

        const losses = [
            { name: 'Startâ†’Trigger\næµå¤±', value: avgStart - avgTrigger },
            { name: 'Triggerâ†’Show\næµå¤±', value: avgTrigger - avgShow },
            { name: 'Showâ†’Click\næµå¤±', value: avgShow - avgClick },
            { name: 'Clickâ†’ä¸‹è½½\næµå¤±', value: avgClick - avgDownSuc },
        ];

        chart.setOption({
            ...chartTheme,
            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(17, 24, 39, 0.95)',
                borderColor: 'rgba(99, 130, 255, 0.2)',
                textStyle: { color: '#f0f4ff', fontSize: 12 },
            },
            xAxis: {
                type: 'category',
                data: losses.map(l => l.name),
                axisLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.2)' } },
                axisLabel: { color: '#8b95b0', fontSize: 11 },
            },
            yAxis: {
                type: 'value',
                axisLine: { show: false },
                splitLine: { lineStyle: { color: 'rgba(99, 130, 255, 0.08)' } },
                axisLabel: {
                    color: '#8b95b0',
                    fontSize: 11,
                    formatter: v => v >= 10000 ? (v/10000).toFixed(0) + 'ä¸‡' : v >= 1000 ? (v/1000).toFixed(0) + 'k' : v,
                },
            },
            series: [{
                type: 'bar',
                data: losses.map(l => l.value),
                barWidth: 40,
                itemStyle: {
                    borderRadius: [6, 6, 0, 0],
                    color: (params) => {
                        const colors = ['#fb7185', '#f97316', '#f43f5e', '#ef4444'];
                        return colors[params.dataIndex];
                    },
                },
                label: {
                    show: true,
                    position: 'top',
                    color: '#fb7185',
                    fontSize: 12,
                    fontWeight: 600,
                    formatter: p => formatNum(p.value),
                },
            }],
        });
        window.addEventListener('resize', () => chart.resize());
    }

    // ==================== TABLE ====================
    function renderTable() {
        const tbody = document.getElementById('detailTable').querySelector('tbody');
        tbody.innerHTML = mainData.map(d => {
            const triggerRate = pct(d.trigger, d.start);
            const clickRate = pct(d.click, d.show);
            const downRate = d.click > 0 ? pct(d.down_suc, d.click) : 0;

            const clickBadge = clickRate >= 1.2 ? 'good' : clickRate >= 0.8 ? 'warn' : 'bad';
            const downBadge = downRate >= 90 ? 'good' : downRate >= 70 ? 'warn' : 'bad';

            return `<tr>
                <td>${d.date}</td>
                <td>${d.start.toLocaleString()}</td>
                <td>${d.trigger.toLocaleString()}</td>
                <td>${d.show.toLocaleString()}</td>
                <td>${d.click.toLocaleString()}</td>
                <td>${d.close.toLocaleString()}</td>
                <td>${d.notips}</td>
                <td>${d.down_suc}</td>
                <td>${d.down_end_suc}</td>
                <td>${triggerRate.toFixed(1)}%</td>
                <td><span class="rate-badge ${clickBadge}">${clickRate.toFixed(2)}%</span></td>
                <td><span class="rate-badge ${downBadge}">${downRate.toFixed(1)}%</span></td>
            </tr>`;
        }).join('');
    }

    // ==================== INIT ====================
    window.addEventListener('load', () => {
        renderKPIs();
        renderTrendChart();
        renderClickRateChart();
        renderDownloadRateChart();
        renderFunnelChart();
        renderConversionBarChart();
        renderBehaviorStackChart();
        renderDownloadChart();
        renderLossChart();
        renderTable();
    });
    </script>
</body>
</html>
